# AWS Budget Setup

## How to Create a Budget
1. Go to the top-right corner and select your account
2. In the dropdown menu, select **Billing and Cost Management**
3. Navigate to **Organization** > **Budgets**
4. Click **Create a budget**
5. Choose your budget type and configure:
   - Zero spend budget
   - Monthly cost budget
   - Daily savings plans coverage budget
   - Daily reservation utilization budget

---

# EC2 (Elastic Compute Cloud)

**EC2 = Infrastructure as a Service (IaaS)**

EC2 provides the capability of:
- Renting virtual machines (EC2 Instances)
- Storing data on virtual drives (EBS)
- Distributing load across machines (ELB)
- Scaling services using an Auto Scaling Group (ASG)

---

## EC2 Sizing & Configuration Options

| Category | Options |
|----------|---------|
| **Operating System** | Linux, Windows, Mac |
| **Compute** | CPU, RAM |
| **Storage** | Network-attached (EBS & EFS), Hardware (EC2 Instance Store) |
| **Network** | Network card speed, Public IP address |
| **Security** | Firewall rules (Security Group) |
| **Automation** | Bootstrap script (EC2 User Data) |

## EC2 User Data

### Overview
- Bootstrap your instance using an **EC2 User Data script**
- **Bootstrapping** = Launching commands when a machine starts
- The script runs **only once** at the instance's first start
- Runs with **root user** privileges

### Common Use Cases
- Installing updates
- Installing software
- Downloading common files from the internet
- Any automation task you need

### Quick Reference

| Question | Answer |
|----------|--------|
| **When does it run?** | Only on EC2 first boot (automatically) |
| **Purpose?** | Automate server setup, installation, and script execution at boot |
| **Who executes it?** | Root user |
| **Where to configure?** | EC2 Launch → Advanced details → User data |
| **Runs on reboot?** | No (by default, can be configured) |
| **Supported OS** | Linux (Bash), Windows (PowerShell) |


## How to Create an EC2 Instance (Linux)
1. In the AWS Management Console, go to **EC2**.
2. In the left menu, select **Instances**, then click **Launch instances**.
3. Configure basic settings:
   - **Name and tags**: e.g. `my-first-instance`
   - **Application and OS Images (AMI)**:
     - Choose a base image from **Quick Start** (e.g. Amazon Linux 2, 64‑bit (x86))
   - **Instance type**:
     - `t2.micro` (Free Tier eligible)
     - Other instance types as needed
   - **Key pair (login)**:
     - Create or select a key pair
     - **Key pair type**: RSA
     - **Private key file format**:
       - `.pem` (Linux, macOS, Windows 10+ using OpenSSH)
       - `.ppk` (Windows using PuTTY)
   - **Network settings**:
     - Enable **Auto-assign public IP** (if the instance must be reachable from the internet)
     - Configure **Security group** (firewall):
       - Allow **SSH (TCP 22)** from **My IP** (recommended) or **Anywhere**
       - Allow **HTTPS (TCP 443)** from the internet
       - Allow **HTTP (TCP 80)** from the internet
   - **Configure storage**:
     - Adjust root volume size and type as needed
   - **Advanced details**:
     - **User data** (runs once on first boot). Example:
      ```bash
      #!/bin/bash
      # Use this for your user data (script runs from top to bottom)
      # Install httpd (Amazon Linux 2)
      yum update -y
      yum install -y httpd
      systemctl start httpd
      systemctl enable httpd
      echo "<h1>Hello World from $(hostname -f)</h1>" > /var/www/html/index.html
      ```

### After the instance is created
- **Instance ID**: unique identifier
- **Public IPv4 address**: used to access the instance from the internet (may change on Stop/Start unless you use an Elastic IP)
- **Private IPv4 address / DNS**: used for internal communication inside the VPC (usually stays the same for the life of the instance)
- **Instance state**: current state (running, stopped, terminated, etc.)
- **Hostname**
- **Private IP DNS**
- **AMI ID**
- **Platform** (e.g. Linux, Windows)
- **Key pair name**
- **Security groups**

## EC2 Instance Types 
There are **4 main EC2 instance families**.

### Naming convention
Example: `m5.2xlarge`
- `m`: instance family (e.g., general purpose, compute optimized, etc.)
- `5`: generation (AWS improves them over time → newer = better price/perf)
- `2xlarge`: size within the instance family (vCPUs, memory, network scale together)

### Instance families (high‑level comparison)

| Family | Prefix examples | Optimized for | Typical use cases | Exam tips |
|--------|-----------------|---------------|-------------------|-----------|
| **General purpose** | `t`, `m` | Balanced **compute, memory, and networking** | Web/app servers, dev/test, small DBs, code repos | **Default choice** when you don't have special requirements. Often used in exam as "normal" instance. |
| **Compute optimized** | `c` | High **CPU** performance | Batch processing, media transcoding, high‑perf web servers, HPC, scientific modeling, game servers | When question emphasizes **CPU‑bound / high performance processors**, think **C‑family**. (연산이 복잡한 경우) |
| **Memory optimized** | `r`, `x`, `z1d` | Very high **RAM** per vCPU | In‑memory DBs, high‑perf relational/NoSQL DBs, in‑memory caches, real‑time big data analytics, BI | When question says **"large in‑memory dataset / high performance DB"**, answer is usually **R‑family** (or memory optimized). |
| **Storage optimized** | `i`, `d`, `h`, `im4gn` | High, sequential **disk throughput and IOPS** on local storage | High‑frequency OLTP, large NoSQL DBs, data warehousing, distributed file systems | When you see **"very high I/O / local SSD / large sequential read/write"**, choose **I/D‑family storage optimized**. |

> **Exam shorthand**  
> - **T/M = General purpose**, **C = Compute**, **R = Memory**, **I/D = Storage**  
> - Map keywords in the question (CPU‑bound / in‑memory DB / high IOPS) → the matching family.

## comparsion instances
https://instances.vantage.sh/


## Security Groups

### Overview
- Fundamental building block of **network security** in AWS
- Act as a **virtual firewall** for your EC2 instances
- **Control which traffic is allowed** into (inbound) and out of (outbound) your instances
- Security groups only contain **allow rules** (no explicit deny)
- Rules can reference **IP ranges (CIDR)** or **other security groups**

### Conceptual diagram

```text
        Internet / VPC
             |
       +-------------+
       | Security    |   <-- Security Group (firewall rules)
       |   Group     |
       +-------------+
             |
       +-------------+
       |   EC2       |
       |  Instance   |
       +-------------+
```

Another way to think about multiple security groups and flows:

```text
Your IP (SSH 22)  --->  SG-SSH  --->  EC2 Instance
0.0.0.0/0 (HTTP)  --->  SG-WEB  --->  EC2 Instance

EC2 Instance  --->  SG-OUTBOUND  --->  Internet (0.0.0.0/0)
```

Security groups regulate:
- Access to **ports** (e.g. 22, 80, 443)
- **Authorised IP ranges** (IPv4 and IPv6)
- **Inbound traffic** (from clients to the instance)
- **Outbound traffic** (from the instance to other destinations)

### Inbound/Outbound rules – examples

| Type | Protocol | Port Range | Source | Description |
| ---- | -------- | ---------- | ------ | ----------- |
| HTTP | TCP | 80 | 0.0.0.0/0 (Anywhere) | Public web access |
| SSH | TCP | 22 | Your IP/32 | Admin SSH access |
| Custom TCP Rule | TCP | 4567 | 0.0.0.0/0 | Example app port |

### Good to know (exam friendly)
- Can be attached to **multiple instances**
- Scoped to a **region + VPC** combination
- Live **outside** the EC2 instance – if traffic is blocked, the instance never sees it
- Good practice: maintain a **separate security group for SSH** access
- If your application is **not accessible (timeout)** → usually a **security group / network** issue
- If you get **"connection refused"** → the instance is reachable, but the **application is not running/listening**
- By default: **all inbound traffic is blocked**, **all outbound traffic is allowed**

### Classic ports to know (for the exam)
- **22** = SSH (Secure Shell) – log into a Linux instance
- **21** = FTP (File Transfer Protocol) – upload files to a file share
- **22** = SFTP (SSH File Transfer Protocol) – upload files using SSH
- **80** = HTTP – access unsecured websites
- **443** = HTTPS – access secured websites
- **3389** = RDP (Remote Desktop Protocol) – log into a Windows instance

## SSH Summary Table

SSH is one of the most important tools: it lets you control a remote Linux machine entirely from the command line.

| OS | Built‑in SSH client | PuTTY | EC2 Instance Connect |
|----|---------------------|-------|----------------------|
| **macOS** | ✅ | (optional) | ✅ |
| **Linux** | ✅ | (optional) | ✅ |
| **Windows < 10** | ❌ | ✅ | ✅ |
| **Windows ≥ 10** | ✅ (OpenSSH) | ✅ | ✅ |

> **Exam tip**: On older Windows, you typically use **PuTTY** with a `.ppk` key. On macOS/Linux/modern Windows, you can use the built‑in `ssh` with a `.pem` key.

## Instance Roles (IAM Roles for EC2)

### Using AWS CLI on EC2

```bash
aws --version           # Check AWS CLI version
aws iam list-users     # Example call (requires IAM permissions)

# Avoid configuring long-lived access keys on the instance
aws configure           # Prefer IAM roles over hard-coded access keys
```

### How to attach/change an IAM Role on an EC2 instance
1. Select the EC2 instance in the console.
2. At the top, choose **Actions** → **Security** → **Modify IAM role**.
3. Choose an **IAM role** (e.g., with `IAMReadOnlyAccess` or appropriate permissions).
4. Click **Save** – the IAM role is now attached to the instance.

If your instance does **not** have the right role:
- Calls like `aws iam list-users` will **fail**, even if the CLI is installed.

> **Note**  
> - IAM roles can be attached to compute services such as **EC2, Lambda, ECS**.  
> - Use IAM roles to let these services access **S3, DynamoDB, etc.** **without** hard‑coding access keys (more secure and recommended for the exam).

## EC2 Instance Purchasing Options



### High-level comparison

| Option | Commitment | Discount vs On-Demand | Interruption risk | Capacity guarantee | Typical use cases |
|--------|------------|-----------------------|-------------------|--------------------|-------------------|
| **On-Demand** | None | Baseline (0%) | None | No | Short-term, spiky, unpredictable workloads, PoC |
| **Reserved Instances (RI)** | 1 or 3 years | Up to ~72% | None | Zonal RI can reserve capacity | Steady-state workloads (databases, always-on apps) |
| **Savings Plans** | 1 or 3 years | Up to ~72% | None | No | Steady \$ usage/hour, need flexibility (instances/FaaS) |
| **Spot Instances** | None (but can run long) | Up to ~90% | **High** (can be reclaimed by AWS) | No | Fault-tolerant, flexible-time jobs (batch, big data, CI) |
| **Dedicated Hosts** | 1 or 3 years or On-Demand | N/A (most expensive) | None | Host capacity is yours | License-bound software, strict compliance |
| **Dedicated Instances** | None | More expensive than shared | None | No | Tenant isolation without full host control |
| **Capacity Reservations** | Duration-based (you decide) | **No price discount** | None | **Yes (AZ capacity)** | Short-term need to guarantee capacity in specific AZ |

> **Memory hook**  
> - **Price**: Spot (cheapest) → RI/Savings → On-Demand → Dedicated (most expensive)  
> - **Flexibility**: On-Demand/Spot > Savings Plans > RI > Dedicated Host  
> - **Interruption**: Only **Spot** can be interrupted by AWS.

---

### On-Demand Instances

Pay **per second or per hour** with **no long-term commitment**.

- **Billing**:
  - Linux/Windows: billed **per second** (after first minute)
  - Other OS: billed **per hour**
- **Pros**:
  - No upfront payment
  - Start/stop anytime
  - Perfect when you **cannot predict** workload behavior
- **Cons**:
  - **Highest cost** per hour (no discount)
- **Use cases (exam)**:
  - **Short-term**, **uninterrupted** workloads
  - First time deploying an app / PoC / unpredictable traffic

> **Exam tip**: When you see *“short-term, spiky, unpredictable usage, no long-term commitment”* → answer is **On-Demand**.

---

### Reserved Instances (RIs) – 1 & 3 Years

You commit to specific **instance attributes** for **1 or 3 years** in exchange for a big discount.

- **Attributes you reserve**:
  - Instance type, Region, Tenancy, OS
- **Term**:
  - **1 year** (less discount) or **3 years** (more discount)
- **Payment options**:
  - **No upfront** – lowest discount
  - **Partial upfront** – medium discount
  - **All upfront** – highest discount
- **Discount**:
  - Up to **~72%** compared to On-Demand
- **Scope**:
  - **Regional RI**: applies to matching usage in a Region (no capacity guarantee)
  - **Zonal RI**: tied to a specific AZ → **capacity reservation** in that AZ
- **Use cases (exam)**:
  - **Steady-state usage** (e.g., production databases, always-on applications)

#### Convertible Reserved Instances

Provide **flexibility** to change some attributes during the term.

- Can change: instance **type**, **family**, **OS**, **tenancy**, **scope**
- Discount: up to **~66%** (slightly less than Standard RIs, but more flexible)

> **Standard vs Convertible RI (exam)**  
> - **Standard RI**: **maximum discount**, but fixed attributes.  
> - **Convertible RI**: **lower discount**, but you can change attributes over time.

---

### Savings Plans (1 & 3 Years)

Savings Plans are a **commitment to spend a certain \$ amount/hour** for 1 or 3 years, in exchange for lower prices.

- **Commitment model**:
  - Commit to **\$ X/hour** of compute usage (e.g. \$10/hour) for 1 or 3 years
- **Discount**:
  - Up to **~72%**, similar to RIs
- **Pricing behavior**:
  - Usage **up to the committed amount** is billed at **discounted Savings Plans rates**
  - Usage **beyond** the commitment is billed at **On-Demand** prices
- **Types** (exam important):
  - **Compute Savings Plans** (most flexible)
    - Applies across **regions**, **instance families**, **OS**, plus **Fargate** and **Lambda**
  - **EC2 Instance Savings Plans** (less flexible, more like RI)
    - Locked to **specific instance family + region** (e.g. `m5` in `us-east-1`)
    - Flexible across **size, OS, tenancy** within that family

> **Exam tip**  
> - Question mentions **“\$ per hour commitment, flexible across instance families/services”** → **Savings Plans**.  
> - Question mentions **“commit to specific instance attributes”** → **RIs**.

---

### Spot Instances

Heavily discounted capacity that AWS can **reclaim at any time**.

- **Discount**:
  - Up to **~90%** cheaper than On-Demand
- You define a **maximum price**; instance runs while:
  - Current **Spot price ≤ your max price**
  - Capacity is available
- **Interruption**:
  - AWS can **stop or terminate** your Spot Instance with **2 minutes notice**
- **Use cases (exam)** – must be **fault-tolerant**:
  - Batch processing
  - Big data / analytics
  - Image / media processing
  - CI jobs
  - Any **distributed, stateless** workloads
- **Not suitable for**:
  - **Critical jobs** or **databases**

> **Exam keywords for Spot**: “flexible start and end time”, “can handle interruptions”, “very low cost”, “stateless batch processing”.

#### Spot interruption behavior

- If **current Spot price > your max price**, or AWS needs capacity:
  - Your instance can be **stopped** or **terminated** after a **2-minute warning**

#### Spot Fleets

Spot Fleet = **set of Spot Instances + (optional) On-Demand Instances** managed together.

- Goal: meet a **target capacity** with **price constraints**
- You define possible **launch pools**:
  - Instance type, OS, Availability Zone, etc.
- Spot Fleet strategies (exam):
  - **lowestPrice** – choose the pool with the lowest Spot price
  - **diversified** – distribute across all pools to spread risk
  - **capacityOptimized** – choose pools with the most available capacity (**recommended**)
- Spot Fleet stops launching instances when:
  - It reaches the **target capacity** or **max cost**

> **Note on Spot Blocks (legacy)**  
> - “Spot Block” allowed you to block instances for **1–6 hours without interruption**.  
> - No longer offered to new customers and fully deprecated, but **may still appear in the exam**.

> **How to safely terminate Spot Instances**  
> - Spot can be **stopped** when price exceeds your max, but **not automatically terminated**.  
> - To terminate: first **cancel the Spot request**, then **terminate the associated Spot Instances**.

---

### Dedicated Hosts

You get an entire **physical server** dedicated to your use.

- **What you get**:
  - Full control over **instance placement** on a physical host
  - Useful for **license-bound software** (BYOL – Bring Your Own License)
  - Helps meet **compliance / regulatory** requirements
- **Purchasing options**:
  - On-Demand: pay per second for an active Dedicated Host
  - Reserved: 1 or 3 years (No upfront, Partial upfront, All upfront)
- **Cost**:
  - **Most expensive** EC2 option
- **Use cases (exam)**:
  - Software that needs **per-socket / per-core / per-host** licensing
  - Companies with **strong regulatory or compliance** needs

---

### Dedicated Instances

Instances that run on hardware **dedicated to a single customer**, but you **don’t manage the host**.

- No other AWS customers will share your hardware
- But multiple **instances in your own account** can share the same hardware
- **No control** over precise instance placement (AWS can move instances after stop/start)

> **Dedicated Host vs Dedicated Instance (exam)**  
> - **Dedicated Host**: visibility and control over **physical host**, needed for **license / compliance**.  
> - **Dedicated Instance**: just isolation at hardware level, **no host control or visibility**.

---

### Capacity Reservations

Guarantee that you have **On-Demand capacity in a specific AZ**.

- Reserve **On-Demand instance capacity** in a specific **AZ** for **any duration**
- You always have access to EC2 capacity when you need it
- **No time commitment** (create/cancel anytime), but **no billing discounts**
- You are charged at **On-Demand rates**, whether you run instances or not
- You can **combine** Capacity Reservations with **Regional RIs** or **Savings Plans** to still get billing discounts
- **Use cases (exam)**:
  - Short-term, **uninterrupted workloads** that must be in a **specific AZ**
  - When you must be sure capacity is available at a particular time (e.g. big launch, migration cutover)

> **Capacity Reservation vs On-Demand (key confusion)**  
> - Both pay **On-Demand price**, but:  
>   - **On-Demand only**: capacity is **best-effort**, not guaranteed.  
>   - **Capacity Reservation**: you **reserve AZ capacity** ahead of time so that your future On-Demand launches are guaranteed.
